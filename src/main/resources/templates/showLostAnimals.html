<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Animal perdu rayon de 30 kilomètres</title>
</head>
<body>
    <!DOCTYPE html>

<head>
    <meta charset="UTF-8">
    <title>Adoption</title>

    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
        integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <link rel="stylesheet" href="css/adoption_afficher_animal.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css"
        integrity="sha512-z3gLpd7yknf1YoNbCzqRKc4qyor8gaKU1qmn+CShxbuBusANI9QpRohGBreCFkKxLhei6S9CQXFEbbKuqLg0DA=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />

    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
    <script src="https://kit.fontawesome.com/b99e675b6e.js"></script>
</head>

<body>


    <style>
        body {
            display: flex;

        }

        .top-right {
            width: 40px;
            height: 40px;
            border: 1px solid #000;
            border-radius: 50%;
            background-color: #000;
            padding: 20px;
            font-weight: bold;
            color: #fff;
            border: 0;
            outline: none;
            position: absolute;
            top: 20px;
            right: 20px;
            font-size: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10;
        }

        /* sitde bar */

        .w3-sidebar {
            position: fixed;
            z-index: 100;
            background-color: #000;
            display: flex;
            flex-direction: column;
            color: #fff;
            width: 250px;
            padding: 20px;
            height: 100vh;
            overflow-y: auto;
        }

        .w3-button {
            color: #fff;
            outline: none;
            outline: none;
            padding: 10px;
            text-decoration: none;
            transition: 0.5s;
        }


        .w3-button:hover {
            background-color: #fff;
            text-decoration: none;
            color: #81774E;
            border-radius: 6px;
        }

        .w3-button:hover a {
            color: #000;
        }

        .logo-img {
            text-align: CENTER;
            margin: 20PX AUTO;
            width: 100PX;
        }

        .side_bar_bar {
            background-color: #81774E;
        border: 0;
        height: 1px;
        width: 100%;
        border-radius: 2px;
        margin: 10px 0;
        }
    </style>

 <!-- Sidebar -->
<div class="w3-sidebar ">
    <img src="images/logo.png" alt="Logo" class="logo-img">
    <a href="/profile" class="w3-button">Mon compte</a>
    <a href="/mesCandidatures" class="w3-button">Mes candidatures</a>
    <hr class="side_bar_bar">
    </hr>
    <a href="/mesanimaux" class="w3-button">Mes animaux</a>

    <a href="/adoption" class="w3-button">Adoption</a>
    <a href="/AddAnimal" class="w3-button">Inscrire un animal</a>

    <hr class="side_bar_bar">
    </hr>
    <a href="/donate" class="w3-button">Donner des objets</a>
    <a href="/showdonations" class="w3-button">Trouver des objets</a>
    <a href="/mesdonations" class="w3-button">Mes objets à donné</a>

    <hr class="side_bar_bar">
    <a href="/Map" class="w3-button">Map</a>

    <hr class="side_bar_bar">
    <a href="/AddEvent" class="w3-button">Ajouter un évenement</a>
    <a href="/ShowEvent" class="w3-button">Participé a un evenement</a>
    <a href="/MyEvent" class="w3-button">Mes évenement crée </a>


    <hr class="side_bar_bar">
    </hr>
    <a href="#" class="w3-button">Se Déconnecter</a>

</div>

<div class="big-container">
    <div class="wrapper">
        <div class="container">
            <h2 class="small-title">Les animaux perdus dans un rayon de 30 km autour de votre position (${latitude}, ${longitude})</h2>
            <div class="animal">
                <!-- Ajouter un champ caché pour l'ID de la personne -->

                <div class="animal-container">
                    <!-- Liste des animaux ici -->
                </div>
                <div id="error-message"></div>
            </div>
        </div>
    </div>
</div>
<script>
    // Vérifier si le navigateur supporte la géolocalisation
    if ("geolocation" in navigator) {
        navigator.geolocation.getCurrentPosition(function(position) {
            // Récupérer les coordonnées de latitude et longitude
            var latitude = position.coords.latitude;
            var longitude = position.coords.longitude;
            var animalsContainer = document.querySelector(".animal-container");
            var smallTitle = document.querySelector(".small-title")
            smallTitle.innerHTML = "Latitude: " + latitude + ", Longitude: " + longitude + "  30 km rayon";
            // Faire une requête AJAX pour récupérer les animaux dans un rayon de 30 km autour de la position de l'utilisateur
            var url = "http://localhost:8086/animals-within-radius?latitude=" + latitude + "&longitude=" + longitude;
            fetch(url)
                .then(response => response.json())
                .then(data => {
                    // Afficher les animaux récupérés sur la page HTML en utilisant le template
                    data.forEach(animal => {
                        var animalItem = document.createElement("div");
                        animalItem.classList.add("animal-item");

                        animalItem.innerHTML = `
                            <div class="animal-img">
                                <img src="/images/animals/${animal.imageUrl}" alt="animal image">
                            
                                <div>
                                      <!-- ajoutes les boutton ici -->
                                </div>
                            </div>
                            <div class="animal-content">
                                <h2 href="#" class="animal-title">${animal.name}</h2>
                                <p class="race"><span>${animal.race}</span></p>
                                <span class="gender">${animal.gender === 1 ? '♂ Mâle' : '♀ Femelle'}</span>
                            </div>
                        `;

                        animalsContainer.appendChild(animalItem);
                    });
                })
                .catch(error => console.error('Erreur lors de la récupération des animaux:', error));
        });
    } else {
        console.log("La géolocalisation n'est pas prise en charge par ce navigateur.");
    }
</script>

    
    
    
    
</body>
</html>
